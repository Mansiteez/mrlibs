par(mar = c(5, 4, 4, 2) + 0.1)  # Modify the values as needed
min_errors <- c()
table_df <- as.data.frame(table@mat.fdr)
for (i in 1:nrow(table_df)) {
delta_value <- table_df$Delta[i]
DEG<-list.siggenes(sam.out,delta_value)
DEGdf<-subset(data,select=c(DEG))
TDEGdf<-t(DEGdf)
TrainData<-list(x=TDEGdf,y=cl)
PAMtable<-pamr.train(TrainData)
CVtable<-pamr.cv(PAMtable,TrainData, nfold=5)
#result<-pamr.plotcv(CVtable)
#results <- c(results, result)
#CVtable
pamr.confusion(CVtable, threshold=CVtable$threshold[which(CVtable$error==min(CVtable$error))][1])
pamcen<-pamr.listgenes(PAMtable, TrainData, threshold=CVtable$threshold[which(CVtable$error==min(CVtable$error))][1])
#colnames(pamcen)<-c("genes",colnames(pamcen)[-1])
#min_error <- min(CVtable$error)
#min_errors <- c(min_errors, min_error)
}
par(mar = c(5, 4, 4, 2) + 0.1)  # Modify the values as needed
min_errors <- c()
table_df <- as.data.frame(table@mat.fdr)
for (i in 1:nrow(table_df)) {
delta_value <- table_df$Delta[i]
DEG<-list.siggenes(sam.out,delta_value)
DEGdf<-subset(data,select=c(DEG))
TDEGdf<-t(DEGdf)
TrainData<-list(x=TDEGdf,y=cl)
PAMtable<-pamr.train(TrainData)
CVtable<-pamr.cv(PAMtable,TrainData, nfold=5)
#result<-pamr.plotcv(CVtable)
#results <- c(results, result)
#CVtable
pamr.confusion(CVtable, threshold = CVtable$threshold[which(CVtable$error == min(CVtable$error))][1])
pamcen <- pamr.listgenes(PAMtable, TrainData, threshold = CVtable$threshold[which(CVtable$error == min(CVtable$error))][1])
colnames(pamcen) <- c("genes", colnames(pamcen)[-1])
#min_error <- min(CVtable$error)
#min_errors <- c(min_errors, min_error)
}
library(readr)
library(siggenes)
library(pamr)
# Read the expression data and clinical data
data <- read.csv("2023_03_28_biopsy_clinical_combined_57_samples_expression.csv")
# Read the expression data and clinical data
data <- read.csv("2023_03_28_biopsy_clinical_combined_57_samples_expression.csv")
dataID <- read_csv("2023_03_28_biopsy_clinical_combined_57_samples_CMS.csv")
# Extract the class labels
cl <- c(dataID$Subtype)
# Transpose the expression data
TData <- t(data)
# Run the SAM algorithm
sam.out <- sam(TData, cl, rand = 123)
# View the summary of SAM results
View(sam.out)
# Obtain the summary table of SAM results
table <- summary(sam.out)
# Initialize a vector to store the results
results <- c()
# Convert the summary table to a data frame
table_df <- as.data.frame(table@mat.fdr)
# Iterate over each delta value in the summary table
for (i in 1:nrow(table_df)) {
delta_value <- table_df$Delta[i]
# Select differentially expressed genes based on the delta value
DEG <- list.siggenes(sam.out, delta_value)
DEGdf <- subset(data, select = c(DEG))
TDEGdf <- t(DEGdf)
TrainData <- list(x = TDEGdf, y = cl)
# Train the PAM model
PAMtable <- pamr.train(TrainData)
# Perform cross-validation
CVtable <- pamr.cv(PAMtable, TrainData)
# Plot the cross-validation results
result <- pamr.plotcv(CVtable)
results <- c(results, result)
# Calculate the confusion matrix using the optimal threshold
pamr.confusion(CVtable, threshold = CVtable$threshold[which(CVtable$error == min(CVtable$error))][1])
# Generate a list of differentially expressed genes
pamcen <- pamr.listgenes(PAMtable, TrainData, threshold = CVtable$threshold[which(CVtable$error == min(CVtable$error))][1])
# Update column names of the gene list
colnames(pamcen) <- c("genes", colnames(pamcen)[-1])
# Print the dimensions of the gene list
print(dim(pamcen))
}
# Convert the summary table to a data frame
table_df <- as.data.frame(table@mat.fdr)
par(mar = c(5, 4, 4, 2) + 0.1)  # Change the values in the 'mar' argument to adjust margins
# Iterate over each delta value in the summary table
for (i in 1:nrow(table_df)) {
delta_value <- table_df$Delta[i]
# Select differentially expressed genes based on the delta value
DEG <- list.siggenes(sam.out, delta_value)
DEGdf <- subset(data, select = c(DEG))
TDEGdf <- t(DEGdf)
TrainData <- list(x = TDEGdf, y = cl)
# Train the PAM model
PAMtable <- pamr.train(TrainData)
# Perform cross-validation
CVtable <- pamr.cv(PAMtable, TrainData)
# Plot the cross-validation results
result <- pamr.plotcv(CVtable)
results <- c(results, result)
# Calculate the confusion matrix using the optimal threshold
pamr.confusion(CVtable, threshold = CVtable$threshold[which(CVtable$error == min(CVtable$error))][1])
# Generate a list of differentially expressed genes
pamcen <- pamr.listgenes(PAMtable, TrainData, threshold = CVtable$threshold[which(CVtable$error == min(CVtable$error))][1])
# Update column names of the gene list
colnames(pamcen) <- c("genes", colnames(pamcen)[-1])
# Print the dimensions of the gene list
print(dim(pamcen))
}
library(readr)
library(siggenes)
library(pamr)
# Read the expression data and clinical data
data <- read.csv("2023_03_28_biopsy_clinical_combined_57_samples_expression.csv")
# Iterate over each delta value in the summary table
for (i in 1:nrow(table_df)) {
delta_value <- table_df$Delta[i]
# Select differentially expressed genes based on the delta value
DEG <- list.siggenes(sam.out, delta_value)
DEGdf <- subset(data, select = c(DEG))
TDEGdf <- t(DEGdf)
TrainData <- list(x = TDEGdf, y = cl)
# Train the PAM model
PAMtable <- pamr.train(TrainData)
# Perform cross-validation
CVtable <- pamr.cv(PAMtable, TrainData)
par(mar = c(4, 4, 2, 1))  # Adjust the margin values as needed
# Plot the cross-validation results
result <- pamr.plotcv(CVtable)
results <- c(results, result)
# Calculate the confusion matrix using the optimal threshold
pamr.confusion(CVtable, threshold = CVtable$threshold[which(CVtable$error == min(CVtable$error))][1])
# Generate a list of differentially expressed genes
pamcen <- pamr.listgenes(PAMtable, TrainData, threshold = CVtable$threshold[which(CVtable$error == min(CVtable$error))][1])
# Update column names of the gene list
colnames(pamcen) <- c("genes", colnames(pamcen)[-1])
# Print the dimensions of the gene list
print(dim(pamcen))
}
table_df <- as.data.frame(table@mat.fdr)
for (i in 1:nrow(table_df)) {
delta_value <- table_df$Delta[i]
DEG<-list.siggenes(sam.out,delta_value)
DEGdf<-subset(data,select=c(DEG))
TDEGdf<-t(DEGdf)
TrainData<-list(x=TDEGdf,y=cl)
PAMtable<-pamr.train(TrainData)
CVtable<-pamr.cv(PAMtable,TrainData, nfold=5)
# Calculate the confusion matrix using the optimal threshold
pamr.confusion(CVtable, threshold = CVtable$threshold[which(CVtable$error == min(CVtable$error))][1])
# Generate a list of differentially expressed genes
pamcen <- pamr.listgenes(PAMtable, TrainData, threshold = CVtable$threshold[which(CVtable$error == min(CVtable$error))][1])
# Update column names of the gene list
colnames(pamcen) <- c("genes", colnames(pamcen)[-1])
# Print the dimensions of the gene list
print(dim(pamcen))
}
table_df <- as.data.frame(table@mat.fdr)
for (i in 1:nrow(table_df)) {
delta_value <- table_df$Delta[i]
DEG<-list.siggenes(sam.out,delta_value)
DEGdf<-subset(data,select=c(DEG))
TDEGdf<-t(DEGdf)
TrainData<-list(x=TDEGdf,y=cl)
PAMtable<-pamr.train(TrainData)
CVtable<-pamr.cv(PAMtable,TrainData, nfold=5)
# Calculate the confusion matrix using the optimal threshold
pamr.confusion(CVtable, threshold = CVtable$threshold[which(CVtable$error == min(CVtable$error))][1])
# Generate a list of differentially expressed genes
pamcen <- pamr.listgenes(PAMtable, TrainData, threshold = CVtable$threshold[which(CVtable$error == min(CVtable$error))][1])
# Update column names of the gene list
colnames(pamcen) <- c("genes", colnames(pamcen)[-1])
# Print the dimensions of the gene list
print(dim(pamcen))
}
cl<-c(dataID$Subtype)
cl
TData<-t(data)
TData
sam.out<-sam(TData,cl,rand=123)
View(sam.out)
table<-summary(sam.out)
table
results <- c()
table_df <- as.data.frame(table@mat.fdr)
for (i in 1:nrow(table_df)) {
delta_value <- table_df$Delta[i]
DEG<-list.siggenes(sam.out,delta_value)
DEGdf<-subset(data,select=c(DEG))
TDEGdf<-t(DEGdf)
TrainData<-list(x=TDEGdf,y=cl)
PAMtable<-pamr.train(TrainData)
CVtable<-pamr.cv(PAMtable,TrainData, nfold=5)
# Calculate the confusion matrix using the optimal threshold
pamr.confusion(CVtable, threshold = CVtable$threshold[which(CVtable$error == min(CVtable$error))][1])
# Generate a list of differentially expressed genes
pamcen <- pamr.listgenes(PAMtable, TrainData, threshold = CVtable$threshold[which(CVtable$error == min(CVtable$error))][1])
# Update column names of the gene list
colnames(pamcen) <- c("genes", colnames(pamcen)[-1])
# Print the dimensions of the gene list
print(dim(pamcen))
}
par(mar = c(5, 4, 4, 2) + 0.1)  # Modify the values as needed
min_errors <- c()
table_df <- as.data.frame(table@mat.fdr)
for (i in 1:nrow(table_df)) {
delta_value <- table_df$Delta[i]
DEG<-list.siggenes(sam.out,delta_value)
DEGdf<-subset(data,select=c(DEG))
TDEGdf<-t(DEGdf)
TrainData<-list(x=TDEGdf,y=cl)
PAMtable<-pamr.train(TrainData)
CVtable<-pamr.cv(PAMtable,TrainData, nfold=5)
#result<-pamr.plotcv(CVtable)
#results <- c(results, result)
#CVtable
pamr.confusion(CVtable, threshold = CVtable$threshold[which(CVtable$error == min(CVtable$error))][1])
pamcen <- pamr.listgenes(PAMtable, TrainData, threshold = CVtable$threshold[which(CVtable$error == min(CVtable$error))][1])
colnames(pamcen) <- c("genes", colnames(pamcen)[-1])
#min_error <- min(CVtable$error)
#min_errors <- c(min_errors, min_error)
}
View(data)
View(data)
View(DEGdf)
par(mar = c(5, 4, 4, 2) + 0.1)  # Modify the values as needed
min_errors <- c()
table_df <- as.data.frame(table@mat.fdr)
for (i in 1:nrow(table_df)) {
delta_value <- table_df$Delta[i]
DEG<-list.siggenes(sam.out,delta_value)
DEGdf<-subset(data,select=c(DEG))
TDEGdf<-t(DEGdf)
TrainData<-list(x=TDEGdf,y=cl)
PAMtable<-pamr.train(TrainData)
CVtable<-pamr.cv(PAMtable,TrainData, nfold=5)
result<-pamr.plotcv(CVtable)
results <- c(results, result)
#CVtable
pamr.confusion(CVtable, threshold = CVtable$threshold[which(CVtable$error == min(CVtable$error))][1])
pamcen <- pamr.listgenes(PAMtable, TrainData, threshold = CVtable$threshold[which(CVtable$error == min(CVtable$error))][1])
colnames(pamcen) <- c("genes", colnames(pamcen)[-1])
#min_error <- min(CVtable$error)
#min_errors <- c(min_errors, min_error)
}
par(mar = c(5, 4, 4, 2) + 0.1)  # Modify the values as needed
min_errors <- c()
table_df <- as.data.frame(table@mat.fdr)
for (i in 1:nrow(table_df)) {
delta_value <- table_df$Delta[i]
DEG<-list.siggenes(sam.out,delta_value)
DEGdf<-subset(data,select=c(DEG))
TDEGdf<-t(DEGdf)
TrainData<-list(x=TDEGdf,y=cl)
PAMtable<-pamr.train(TrainData)
CVtable<-pamr.cv(PAMtable,TrainData, nfold=5)
#result<-pamr.plotcv(CVtable)
#results <- c(results, result)
#CVtable
pamr.confusion(CVtable, threshold = CVtable$threshold[which(CVtable$error == min(CVtable$error))][1])
pamcen <- pamr.listgenes(PAMtable, TrainData, threshold = CVtable$threshold[which(CVtable$error == min(CVtable$error))][1])
colnames(pamcen) <- c("genes", colnames(pamcen)[-1])
#min_error <- min(CVtable$error)
#min_errors <- c(min_errors, min_error)
}
par(mar = c(5, 4, 4, 2) + 0.1)  # Modify the values as needed
min_errors <- c()
table_df <- as.data.frame(table@mat.fdr)
for (i in 1:nrow(table_df)) {
delta_value <- table_df$Delta[i]
DEG<-list.siggenes(sam.out,delta_value)
DEGdf<-subset(data,select=c(DEG))
TDEGdf<-t(DEGdf)
TrainData<-list(x=TDEGdf,y=cl)
PAMtable<-pamr.train(TrainData)
CVtable<-pamr.cv(PAMtable,TrainData, nfold=5)
result<-pamr.plotcv(CVtable)
results <- c(results, result)
#CVtable
pamr.confusion(CVtable, threshold = CVtable$threshold[which(CVtable$error == min(CVtable$error))][1])
pamcen <- pamr.listgenes(PAMtable, TrainData, threshold = CVtable$threshold[which(CVtable$error == min(CVtable$error))][1])
colnames(pamcen) <- c("genes", colnames(pamcen)[-1])
#min_error <- min(CVtable$error)
#min_errors <- c(min_errors, min_error)
}
min_errors <- c()
table_df <- as.data.frame(table@mat.fdr)
for (i in 1:nrow(table_df)) {
delta_value <- table_df$Delta[i]
DEG<-list.siggenes(sam.out,delta_value)
DEGdf<-subset(data,select=c(DEG))
TDEGdf<-t(DEGdf)
TrainData<-list(x=TDEGdf,y=cl)
PAMtable<-pamr.train(TrainData)
CVtable<-pamr.cv(PAMtable,TrainData, nfold=5)
par(mar = c(5, 4, 4, 2) + 0.1)  # Modify the values as needed
result<-pamr.plotcv(CVtable)
results <- c(results, result)
#CVtable
pamr.confusion(CVtable, threshold = CVtable$threshold[which(CVtable$error == min(CVtable$error))][1])
pamcen <- pamr.listgenes(PAMtable, TrainData, threshold = CVtable$threshold[which(CVtable$error == min(CVtable$error))][1])
colnames(pamcen) <- c("genes", colnames(pamcen)[-1])
#min_error <- min(CVtable$error)
#min_errors <- c(min_errors, min_error)
}
table_df <- as.data.frame(table@mat.fdr)
for (i in 1:nrow(table_df)) {
delta_value <- table_df$Delta[i]
DEG<-list.siggenes(sam.out,delta_value)
DEGdf<-subset(data,select=c(DEG))
TDEGdf<-t(DEGdf)
TrainData<-list(x=TDEGdf,y=cl)
PAMtable<-pamr.train(TrainData)
CVtable<-pamr.cv(PAMtable,TrainData, nfold=5)
#par(mar = c(5, 4, 4, 2) + 0.1)  # Modify the values as needed
result<-pamr.plotcv(CVtable)
results <- c(results, result)
#CVtable
#pamr.confusion(CVtable, threshold = CVtable$threshold[which(CVtable$error == min(CVtable$error))][1])
#pamcen <- pamr.listgenes(PAMtable, TrainData, threshold = CVtable$threshold[which(CVtable$error == min(CVtable$error))][1])
#colnames(pamcen) <- c("genes", colnames(pamcen)[-1])
#min_error <- min(CVtable$error)
#min_errors <- c(min_errors, min_error)
}
table_df <- as.data.frame(table@mat.fdr)
for (i in 1:nrow(table_df)) {
delta_value <- table_df$Delta[i]
DEG<-list.siggenes(sam.out,delta_value)
DEGdf<-subset(data,select=c(DEG))
TDEGdf<-t(DEGdf)
TrainData<-list(x=TDEGdf,y=cl)
PAMtable<-pamr.train(TrainData)
CVtable<-pamr.cv(PAMtable,TrainData, nfold=5)
#result<-pamr.plotcv(CVtable)
#results <- c(results, result)
#CVtable
pamr.confusion(CVtable, threshold=CVtable$threshold[which(CVtable$error==min(CVtable$error))][1])
pamcen<-pamr.listgenes(PAMtable, TrainData, threshold=CVtable$threshold[which(CVtable$error==min(CVtable$error))][1])
colnames(pamcen)<-c("genes",colnames(pamcen)[-1])
}
table_df <- as.data.frame(table@mat.fdr)
for (i in 1:nrow(table_df)) {
delta_value <- table_df$Delta[i]
DEG<-list.siggenes(sam.out,delta_value)
DEGdf<-subset(data,select=c(DEG))
TDEGdf<-t(DEGdf)
TrainData<-list(x=TDEGdf,y=cl)
PAMtable<-pamr.train(TrainData)
CVtable<-pamr.cv(PAMtable,TrainData)
result<-pamr.plotcv(CVtable)
results <- c(results, result)
# Calculate misclassification error
misclassification <- 1 - CVtable$error.cv
# Print delta value and corresponding misclassification error
print(paste("Delta:", delta_value, "Misclassification Error:", misclassification))
#CVtable
}
library(readr)
library(siggenes)
library(pamr)
data<-read.csv("2023_03_28_biopsy_clinical_combined_57_samples_expression.csv")
setwd("C:/Users/Rishabh Dhenkawat/Downloads")
library(readr)
library(siggenes)
library(pamr)
data<-read.csv("2023_03_28_biopsy_clinical_combined_57_samples_expression.csv")
data<-read.csv("2023_03_28_biopsy_clinical_combined_57_samples_expression.csv")
dataID<-read_csv("2023_03_28_biopsy_clinical_combined_57_samples_CMS.csv")
cl<-c(dataID$Subtype)
cl
TData<-t(data)
TData
sam.out<-sam(TData,cl,rand=123)
View(sam.out)
table<-summary(sam.out)
table
results <- c()
par(mar = c(5, 4, 4, 2) + 0.1)  # Modify the values as needed
table_df <- as.data.frame(table@mat.fdr)
for (i in 1:nrow(table_df)) {
delta_value <- table_df$Delta[i]
DEG<-list.siggenes(sam.out,delta_value)
DEGdf<-subset(data,select=c(DEG))
TDEGdf<-t(DEGdf)
TrainData<-list(x=TDEGdf,y=cl)
PAMtable<-pamr.train(TrainData)
CVtable<-pamr.cv(PAMtable,TrainData)
result<-pamr.plotcv(CVtable)
results <- c(results, result)
#pamr.confusion(CVtable, threshold = CVtable$threshold[which(CVtable$error == min(CVtable$error))][1])
#pamcen <- pamr.listgenes(PAMtable, TrainData, threshold = CVtable$threshold[which(CVtable$error == min(CVtable$error))][1])
#colnames(pamcen) <- c("genes", colnames(pamcen)[-1])
}
cl<-c(dataID$Subtype)
cl
TData<-t(data)
TData
sam.out<-sam(TData,cl,rand=123)
View(sam.out)
table<-summary(sam.out)
table
results <- c()
table_df <- as.data.frame(table@mat.fdr)
for (i in 1:nrow(table_df)) {
delta_value <- table_df$Delta[i]
DEG<-list.siggenes(sam.out,delta_value)
DEGdf<-subset(data,select=c(DEG))
TDEGdf<-t(DEGdf)
TrainData<-list(x=TDEGdf,y=cl)
PAMtable<-pamr.train(TrainData)
CVtable<-pamr.cv(PAMtable,TrainData)
result<-pamr.plotcv(CVtable)
results <- c(results, result)
#pamr.confusion(CVtable, threshold = CVtable$threshold[which(CVtable$error == min(CVtable$error))][1])
#pamcen <- pamr.listgenes(PAMtable, TrainData, threshold = CVtable$threshold[which(CVtable$error == min(CVtable$error))][1])
#colnames(pamcen) <- c("genes", colnames(pamcen)[-1])
}
data<-read.csv("2023_03_28_biopsy_clinical_combined_57_samples_expression.csv")
dataID<-read_csv("2023_03_28_biopsy_clinical_combined_57_samples_CMS.csv")
cl<-c(dataID$Subtype)
cl
TData<-t(data)
TData
sam.out<-sam(TData,cl,rand=123)
View(sam.out)
table<-summary(sam.out)
table
results <- c()
misclassification_errors <- c()
table_df <- as.data.frame(table@mat.fdr)
for (i in 1:nrow(table_df)) {
delta_value <- table_df$Delta[i]
DEG<-list.siggenes(sam.out,delta_value)
DEGdf<-subset(data,select=c(DEG))
TDEGdf<-t(DEGdf)
TrainData<-list(x=TDEGdf,y=cl)
PAMtable<-pamr.train(TrainData)
CVtable<-pamr.cv(PAMtable,TrainData)
result<-pamr.plotcv(CVtable)
results <- c(results, result)
# Calculate misclassification error
misclassification <- 1 - CVtable$error.cv
# Print delta value and corresponding misclassification error
print(paste("Delta:", delta_value, "Misclassification Error:", misclassification))
#CVtable
}
finDef <- function(data_file, dataID_file, fold) {
library(readr)
library(siggenes)
library(pamr)
# Read the data file
data <- read.csv(data_file)
# Read the dataID file
dataID <- read_csv(dataID_file)
# Extract the class labels
cl <- c(dataID$Subtype)
cl
# Transpose the data matrix
TData <- t(data)
TData
# Perform SAM analysis
sam.out <- sam(TData, cl, rand = 123)
View(sam.out)
# Obtain the summary table of SAM results
table <- summary(sam.out)
table
# Initialize a vector to store the results
results <- c()
# Convert the summary table to a data frame
table_df <- as.data.frame(table@mat.fdr)
# Iterate over each delta value in the summary table
for (i in 1:nrow(table_df)) {
delta_value <- table_df$Delta[i]
# Select list of genes based on the delta value
DEG <- list.siggenes(sam.out, delta_value)
DEGdf <- subset(data, select = c(DEG))
TDEGdf <- t(DEGdf)
TrainData <- list(x = TDEGdf, y = cl)
# Train the PAM model
PAMtable <- pamr.train(TrainData, fold = fold)
# Perform cross-validation
CVtable <- pamr.cv(PAMtable, TrainData)
# Plot the cross-validation results
result <- pamr.plotcv(CVtable)
results <- c(results, result)
# Calculate the threshold with minimum error
threshold <- CVtable$threshold[which(CVtable$error == min(CVtable$error))][1]
# Calculate confusion matrix using the optimal threshold
pamr.confusion(CVtable, threshold = threshold)
# Generate a list of differentially expressed genes
pamcen <- pamr.listgenes(PAMtable, TrainData, threshold = threshold)
# Update column names of the gene list
colnames(pamcen) <- c("genes", colnames(pamcen)[-1])
# Print the dimensions of the gene list
print(dim(pamcen))
# Export pamcen to a CSV file
csv_file <- paste0("pamcen_", delta_value, ".csv")
write.csv(pamcen, file = csv_file, row.names = FALSE)
}
# Return results
return(results)
}
View(perform_sampam_analysis)
View(finDef)
View(perform_sampam_analysis)
View(finDef)
View(perform_sampam_analysis)
View(perform_sampam_analysis)
